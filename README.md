# Sample application to perform a semantic search in a video
## Development setup

Requirements:

-   Docker (and docker-compose)

Requirements (dev):

-   Python 3.12+
-   Poetry
-   npm

Project is using Makefile to simplify the process. Every shell command starts with `make` prefix and should be run from main project directory.

## Installation:

-   `make init` 
- replace params in `.env` with your own values
-   `make build`
-   to set up Python env for IDE to work properly, run `poetry install` from main directory

## Running project:

-  `make it_run` [Vite might complain about http proxy error as it tries to connect to backend before it's up, just refresh the page after backend is up]

You can run backend and frontend on separate tabs in terminal.
-  `make backend_up`
    `make frontend_up`

Running tests:

-   `make test`

## API Documentation

Running project exposes Swagger interface at http://localhost:8008/docs


## Project description
I have tried to implement a simple video search engine. 
Based on my experience, I have decided to use FastAPI as a backend framework and Vite as a frontend framework.

### Search engine
I have tried few different approaches from more to less naive ones.
Although OpenAI API is not open source, I initially tested the results with it. 
After some optimization with frame sampling and resizing I have generated over 500k tokens worth prompt for a 40s long video which proved that it's not the right tool. 

Finally, I have decided to use a simple approach with a pre-trained model from Hugging Face (CLIP). 
I have used a simple DotProduct approach to calculate similarity between video frames and text. 
Cosine similarity is often preferred, but I have decided to use DotProduct as it's faster and initial tests showed good results for few video samples I recorded on my phone.

### Deployment
For the sake of simplicity of the usage I have decided to use Docker container, however virtualization does cripple the performance of the model so in next step this part of the computation should be delegated to a background task running on dedicated hardware.
This decision made the project unusable for videos longer than one minute, but it's a good starting point for demonstration purposes.

### Frontend
This was supposed to be timeboxed to max 2hours I had to give up on custom frontend at all. 
As a quick workaround I have to propose the usage of 'fronted' generated by swagger. (http://localhost:8008/docs)
I'm using a single endpoint for uploading a video and searching to eliminate the need for a persistent storage and modeling VideoFile domain.



